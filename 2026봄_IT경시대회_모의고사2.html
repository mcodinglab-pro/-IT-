<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>엠코딩랩 | IT 경시대회 모의고사 2세트</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Malgun Gothic', sans-serif; background: #f0f2f5; padding: 20px; line-height: 1.6; }
        .container { max-width: 800px; margin: 0 auto; }
        .header { background: #E44D26; color: white; border-radius: 15px; padding: 25px; text-align: center; margin-bottom: 20px; }
        .student-info { background: white; border-radius: 15px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .input-group { display: flex; gap: 10px; flex-wrap: wrap; }
        .input-group input { flex: 1; min-width: 150px; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; }
        .problem-card { background: white; border-radius: 15px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .problem-num { display: inline-block; background: #E44D26; color: white; padding: 4px 12px; border-radius: 20px; font-weight: bold; margin-bottom: 10px; }
        .problem-text { font-weight: bold; margin-bottom: 15px; color: #333; }
        .code-block { background: #2d2d2d; color: #f8f8f2; padding: 15px; border-radius: 8px; font-family: 'Consolas', monospace; font-size: 14px; margin-bottom: 15px; white-space: pre-wrap; }
        .options { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px; margin-bottom: 15px; }
        .option-btn { background: #fff; border: 2px solid #e0e0e0; padding: 10px; border-radius: 8px; cursor: pointer; text-align: left; transition: 0.2s; }
        .option-btn:hover { border-color: #E44D26; background: #fff5f2; }
        .option-btn.selected { background: #E44D26; color: white; border-color: #E44D26; }
        .short-answer { width: 100%; padding: 12px; border: 2px solid #E44D26; border-radius: 8px; font-size: 16px; }
        .submit-section { text-align: center; padding: 40px 0; }
        .submit-btn { background: #E44D26; color: white; border: none; padding: 15px 60px; font-size: 18px; font-weight: bold; border-radius: 30px; cursor: pointer; }
        .result-section { background: white; border-radius: 15px; padding: 30px; text-align: center; display: none; }
        .timer { position: fixed; top: 20px; right: 20px; background: white; padding: 10px 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); font-weight: bold; color: #E44D26; z-index: 100; }
    </style>
</head>
<body>
    <div class="timer" id="timer">⏱️ 00:00</div>
    <div class="container">
        <div class="header">
            <h1>2026 봄 IT 경시대회 모의고사</h1>
            <p>MCODINGLAB | 제2세트 프로그래밍 언어</p>
        </div>
        <div class="student-info">
            <div class="input-group">
                <input type="text" id="studentName" placeholder="이름" required>
                <input type="text" id="birthDate" placeholder="생년월일 (예: 120101)" maxlength="6">
            </div>
        </div>
        <div id="quizContainer"></div>
        <div class="submit-section">
            <button class="submit-btn" id="submitBtn" onclick="submitQuiz()">모의고사 2세트 제출하기</button>
        </div>
        <div class="result-section" id="resultSection">
            <h2>제출 완료!</h2>
            <div style="font-size: 48px; margin: 20px 0;" id="scoreDisplay">0점</div>
            <p>데이터가 구글 시트로 성공적으로 전송되었습니다.</p>
        </div>
    </div>

    <script>
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwoM1Za3S0BUibRYOR4Y_UIg6WNcgsuh2AY16ycYq3EGrkMSN72qXFZXoeLa3e_ssws/exec';

        const problems = [
            { id: 1, q: "실행 결과는?", code: "a = 17\nb = 5\nprint(a % b * 2 + a // b)", type: "choice", opts: ["7", "9", "10", "11", "13"], ans: "1" },
            { id: 2, q: "실행 결과는?", code: 's = "Python"\nprint(s[::-1])', type: "choice", opts: ["Python", "nohtyP", "Pytho", "ython", "P"], ans: "2" },
            { id: 3, q: "실행 결과는?", code: "a = 0\nfor i in range(1, 20, 3):\n    a += 1\nprint(a)", type: "choice", opts: ["5", "6", "7", "8", "19"], ans: "3" },
            { id: 4, q: "실행 결과는?", code: "a = [5, 3, 8, 1, 9]\nprint(max(a) - min(a))", type: "choice", opts: ["4", "6", "8", "10", "14"], ans: "3" },
            { id: 5, q: "다음 프로그램의 실행 결과는 무엇인가?", code: 'print("{:>8}".format("ABC"))', type: "choice", opts: ["ABC", "_____ABC", "___ABC", "ABC_____", "___ABC__"], ans: "2" },
            { id: 6, q: "실행 결과는?", code: "a = 1\nfor i in range(1, 5):\n    a *= i\nprint(a)", type: "choice", opts: ["10", "12", "20", "24", "120"], ans: "4" },
            { id: 7, q: "실행 결과는?", code: 's = "hello world"\nprint(s.count("l"))', type: "choice", opts: ["1", "2", "3", "4", "5"], ans: "3" },
            { id: 8, q: "실행 결과는?", code: "a = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]\ns = 0\nfor i in range(3):\n    s += a[i][i]\nprint(s)", type: "choice", opts: ["6", "12", "15", "18", "45"], ans: "3" },
            { id: 9, q: "실행 결과는?", code: "def f(x):\n    return x * 2\ndef g(x):\n    return x + 3\nprint(f(g(4)))", type: "choice", opts: ["10", "11", "14", "22", "24"], ans: "3" },
            { id: 10, q: "실행 결과는?", code: 'a = "KITPA2025"\nb = ""\nfor c in a:\n    if c.isdigit():\n        b += c\nprint(int(b) + 1)', type: "choice", opts: ["2024", "2025", "2026", "20251", "오류"], ans: "3" },
            { id: 11, q: "실행 결과는?", code: "a = [1, 2, 3]\nb = a\na.append(4)\nprint(len(b))", type: "choice", opts: ["2", "3", "4", "5", "오류"], ans: "3" },
            { id: 12, q: "실행 결과는?", code: "f = lambda x: x if x > 0 else -x\na = [-3, 5, -7, 2, -1]\nprint(sum(map(f, a)))", type: "choice", opts: ["4", "10", "14", "18", "22"], ans: "4" },
            { id: 13, q: "실행 결과는?", code: "def f(n, m):\n    if m == 0: return 1\n    if m % 2 == 0:\n        t = f(n, m // 2)\n        return t * t\n    return n * f(n, m - 1)\nprint(f(2, 10) % 100)", type: "choice", opts: ["4", "12", "24", "48", "96"], ans: "3" },
            { id: 14, q: "실행 결과는?", code: 'a = {}\nwords = ["apple", "banana", "apple", "cherry", "banana", "apple"]\nfor w in words:\n    a[w] = a.get(w, 0) + 1\nprint(a["apple"])', type: "choice", opts: ["1", "2", "3", "4", "오류"], ans: "3" },
            { id: 15, q: "collections 모듈 컨테이너가 아닌 것은?", code: "", type: "choice", opts: ["Counter", "deque", "defaultdict", "OrderedDict", "array"], ans: "5" },
            { id: 16, q: "실행 결과는?", code: "a = 156\nb = 0\nwhile a > 0:\n    b += a % 8\n    a //= 8\nprint(b)", type: "choice", opts: ["8", "10", "12", "14", "16"], ans: "3" },
            { id: 17, q: "실행 결과는?", code: "def f(s, e):\n    if s >= e: return 0\n    m = (s + e) // 2\n    return 1 + max(f(s, m), f(m + 1, e))\nprint(f(1, 16))", type: "choice", opts: ["2", "3", "4", "5", "16"], ans: "3" },
            { id: 18, q: "실행 결과는?", code: "a = [3, 1, 4, 1, 5, 9, 2, 6]\nb = sorted(enumerate(a), key=lambda x: -x[1])\nprint(b[0][0])", type: "choice", opts: ["0", "4", "5", "6", "7"], ans: "3" },
            { id: 19, q: "실행 결과는?", code: "a = 45\nb = 75\nwhile b:\n    a, b = b, a % b\nk = (45 // a) * (75 // a)\nprint(k)", type: "choice", opts: ["15", "45", "75", "225", "3375"], ans: "1" },
            { id: 20, q: "실행 결과로 올바른 값을 작성하시오.", code: "def f(n, memo={}):\n    if n in memo: return memo[n]\n    if n <= 2: return n\n    memo[n] = f(n-1) + f(n-2) + f(n-3)\n    return memo[n]\nprint(f(8))", type: "short", ans: "68" }
        ];

        let userAnswers = {};
        let startTime = Date.now();

        function renderQuiz() {
            const container = document.getElementById('quizContainer');
            problems.forEach(p => {
                const card = document.createElement('div');
                card.className = 'problem-card';
                let html = `<div class="problem-num">문제 ${p.id}</div><div class="problem-text">${p.q}</div>`;
                if(p.code) html += `<div class="code-block">${p.code}</div>`;
                
                if(p.type === 'choice') {
                    html += `<div class="options">`;
                    p.opts.forEach((opt, idx) => {
                        html += `<button class="option-btn" id="p${p.id}_o${idx+1}" onclick="selectOption(${p.id}, ${idx+1})">${idx+1}. ${opt}</button>`;
                    });
                    html += `</div>`;
                } else {
                    html += `<input type="text" class="short-answer" id="p${p.id}_ans" placeholder="정답 입력" oninput="saveShort(${p.id}, this.value)">`;
                }
                card.innerHTML = html;
                container.appendChild(card);
            });
        }

        function selectOption(probId, optIdx) {
            problems[probId-1].opts.forEach((_, i) => {
                const el = document.getElementById(`p${probId}_o${i+1}`);
                if(el) el.classList.remove('selected');
            });
            document.getElementById(`p${probId}_o${optIdx}`).classList.add('selected');
            userAnswers[probId] = String(optIdx);
        }

        function saveShort(probId, val) {
            userAnswers[probId] = val.trim();
        }

        async function submitQuiz() {
            const name = document.getElementById('studentName').value;
            const birth = document.getElementById('birthDate').value;
            if(!name || !birth) return alert("응시자 정보를 입력해 주세요.");

            let correct = 0;
            let details = [];
            problems.forEach(p => {
                const isCorrect = userAnswers[p.id] === p.ans;
                if(isCorrect) correct++;
                details.push({ id: p.id, isCorrect: isCorrect });
            });

            const score = Math.round((correct / problems.length) * 100);
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            const timeStr = `${Math.floor(elapsed/60)}분 ${elapsed%60}초`;

            const result = {
                timestamp: new Date().toLocaleString('ko-KR'),
                name: name,
                birthDate: birth,
                score: score,
                time: timeStr,
                details: details
            };

            const btn = document.getElementById('submitBtn');
            btn.disabled = true;
            btn.textContent = "결과 전송 중...";

            try {
                await fetch(WEB_APP_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(result) });
            } catch(e) { console.error(e); }

            document.getElementById('scoreDisplay').textContent = score + "점";
            document.getElementById('quizContainer').style.display = 'none';
            document.getElementById('studentName').parentNode.parentNode.style.display = 'none';
            document.getElementById('resultSection').style.display = 'block';
        }

        setInterval(() => {
            const sec = Math.floor((Date.now() - startTime) / 1000);
            document.getElementById('timer').textContent = `⏱️ ${Math.floor(sec/60).toString().padStart(2,'0')}:${(sec%60).toString().padStart(2,'0')}`;
        }, 1000);

        renderQuiz();
    </script>
</body>
</html>